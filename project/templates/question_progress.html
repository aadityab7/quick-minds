{% extends 'base.html' %}

{% block title %}QUICK MINDS QUESTION{% endblock %}

{% block content %}
	<div class="mx-auto max-w-screen-xl px-4 py-8 sm:px-6 lg:px-8">
		<div id="lower" class="grow py-3 px-3 rounded-t-lg">

			<h1>Progress:</h1>

			<div class="mt-8">
				<div class="flex gap-4 my-4">
					<svg class="hidden w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
    					<path stroke="currentColor" stroke-linejoin="round" stroke-width="2" d="M10 6v4l3.276 3.276M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
  					</svg>

					<svg class="w-6 h-6 text-green-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
    					<path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
  					</svg>

					<h2>Saved Question</h2>
				</div>

				<svg class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 4 15">
				    <path d="M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/>
				</svg>

				<div class="flex gap-4 my-4">
					<svg id = "text_extraction_clock" class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
    					<path stroke="currentColor" stroke-linejoin="round" stroke-width="2" d="M10 6v4l3.276 3.276M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
  					</svg>

					<svg id = "text_extraction_check" class="hidden w-6 h-6 text-green-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
    					<path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
  					</svg>

					<h2>Extracting text from images (if any)</h2>
				</div>

				<svg class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 4 15">
				    <path d="M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/>
				</svg>

				<div class="flex gap-4 my-4">
					<svg id = "similar_question_clock" class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
    					<path stroke="currentColor" stroke-linejoin="round" stroke-width="2" d="M10 6v4l3.276 3.276M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
  					</svg>

					<svg id = "similar_question_check" class="hidden w-6 h-6 text-green-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
    					<path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
  					</svg>
				
					<h2>Finding similar questions</h2>
				</div>

				<svg class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 4 15">
				    <path d="M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/>
				</svg>

				<div class="flex gap-4 my-4">
					<svg id = "web_search_clock" class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
    					<path stroke="currentColor" stroke-linejoin="round" stroke-width="2" d="M10 6v4l3.276 3.276M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
  					</svg>

					<svg id = "web_search_check" class="hidden w-6 h-6 text-green-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
    					<path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
  					</svg>
				
					<h2>searching the web</h2>
				</div>			

				<svg class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 4 15">
				    <path d="M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/>
				</svg>

				<div class="flex gap-4 my-4">
					<svg id = "youtube_search_clock" class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
    					<path stroke="currentColor" stroke-linejoin="round" stroke-width="2" d="M10 6v4l3.276 3.276M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
  					</svg>

					<svg id = "youtube_search_check" class="hidden w-6 h-6 text-green-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
    					<path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
  					</svg>
				
					<h2>Getting relevant YouTube videos</h2>
				</div>

				<svg class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 4 15">
				    <path d="M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/>
				</svg>

				<div class="flex gap-4 my-4">
					<svg id = "ai_response_clock" class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
    					<path stroke="currentColor" stroke-linejoin="round" stroke-width="2" d="M10 6v4l3.276 3.276M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
  					</svg>

					<svg id = "ai_response_check" class="hidden w-6 h-6 text-green-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
    					<path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
  					</svg>
				
					<h2>Generating AI response</h2>
				</div>

				<svg class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 4 15">
				    <path d="M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/>
				</svg>

				<div class="flex gap-4 my-4">
					<svg id = "redirect_clock" class="w-6 h-6 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
    					<path stroke="currentColor" stroke-linejoin="round" stroke-width="2" d="M10 6v4l3.276 3.276M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
  					</svg>

					<svg id = "redirect_check" class="hidden w-6 h-6 text-green-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
    					<path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/>
  					</svg>
				
					<h2>Redirecting to question page</h2>
				</div>
			
			</div>

		</div>
	</div>

	<script type="text/javascript">
		var question_id = {{question_id}};
		var additional_steps_done = 0;

		function extract_text_from_images() {

			$.ajax({
	            type: 'POST',
	            url: '/question_step_text_extraction',
	            data: {question_id: question_id},
	            success: function (data) {
	            	if(data.response_status === "OK") {
	            		document.getElementById('text_extraction_clock').classList.add('hidden');
	            		document.getElementById('text_extraction_check').classList.remove('hidden');

	            		perform_additional_steps();
	            	}
	            },
	            error: function(xhr, status, error) {
	                console.error('Error in extract_text_from_images:', error);
	            }
	        });
		}

		function perform_additional_steps() {
			
			$.ajax({
	            type: 'POST',
	            url: '/question_step_ai_response',
	            data: {question_id: question_id},
	            success: function (data) {
	            	if(data.response_status === "OK") {
	            		document.getElementById('ai_response_clock').classList.add('hidden');
	            		document.getElementById('ai_response_check').classList.remove('hidden');
	            		redirect_to_question_details_page();
	            	}
	            },
	            error: function(xhr, status, error) {
	                console.error('Error in question_step_ai_response:', error);
	            }
	        });

	        $.ajax({
	            type: 'POST',
	            url: '/question_step_similar_question',
	            data: {question_id: question_id},
	            success: function (data) {
	            	if(data.response_status === "OK") {
	            		document.getElementById('similar_question_clock').classList.add('hidden');
	            		document.getElementById('similar_question_check').classList.remove('hidden');
	            		redirect_to_question_details_page();
	            	}
	            },
	            error: function(xhr, status, error) {
	                console.error('Error in question_step_similar_question:', error);
	            }
	        });

	        $.ajax({
	            type: 'POST',
	            url: '/question_step_web_search',
	            data: {question_id: question_id},
	            success: function (data) {
	            	if(data.response_status === "OK") {
	            		document.getElementById('web_search_clock').classList.add('hidden');
	            		document.getElementById('web_search_check').classList.remove('hidden');
	            		redirect_to_question_details_page();
	            	}
	            },
	            error: function(xhr, status, error) {
	                console.error('Error in question_step_web_search:', error);
	            }
	        });
	        
	        $.ajax({
	            type: 'POST',
	            url: '/question_step_youtube_search',
	            data: {question_id: question_id},
	            success: function (data) {
	            	if(data.response_status === "OK") {
	            		document.getElementById('youtube_search_clock').classList.add('hidden');
	            		document.getElementById('youtube_search_check').classList.remove('hidden');
	            		redirect_to_question_details_page();
	            	}
	            },
	            error: function(xhr, status, error) {
	                console.error('Error in question_step_youtube_search:', error);
	            }
	        });
		}

		function redirect_to_question_details_page() {
			if (additional_steps_done === 4){
				//redirect to question details page
				console.log("redirecting to question details page")
			}
			else{
				console.log("another step done!!")
				additional_steps_done = additional_steps_done + 1;
			}
		}

		//extract_text_from_images();
	</script>
{% endblock %}